//我的鱼古
//http://www.fish.com/api.php/member/index/score_list
//POST['key'] = '1234'
//type[0=收入，1=支出]

$(function() {
    var key = getcookie('key');
    if (key == '') {
        location.href = '/login.html';
    }
	var isok = false;
	init();

	$('#all').click(function() {
		if ($('#all').html() == $('.active').html()) {
			return false;
		} else {
			$(this).addClass('active').siblings().removeClass('active');
			$('.out').show();
			$('.in').show();
		}
	})

	$('#in').click(function() {
		$(this).addClass('active').siblings().removeClass('active');
		$('.out').hide();
		$('.in').show();
	})
	$('#out').click(function() {
		$(this).addClass('active').siblings().removeClass('active');
		$('.out').show();
		$('.in').hide();
	})

	function init() {
		$.ajax({
			url: ApiUrl + "/member/index/score_list",
			type: 'POST',
			data: {
				key: key
			},
			timeout: '16000',
			error: function(a, b, c) {
				NProgress.done();
				if (c != "error") {
					$(window).apptip({
						msg: c
					});
				} else {
					$(window).apptip({
						msg: "加载失败，请检查网络设置"
					});
				}
			},
			success: function(result) {
				NProgress.done();
				var data = result.datas;
				var html = '';
				if (data == null) {
					location.href = '/404.html';
					return;
				}
				isok = true;
				html = template.render('score_list', data);
				$("#main-container").html(html);


			}
		});

	}
	//自动显示回到顶部按钮
	var scrolll_hght;
	var totophtml = '';
	$(window).scroll(function() {
		var dh = $(document).height(); //整个页面文档的高度
		var to_top = $(this).scrollTop(); //滚动条的高度
		var wh = $(this).height(); //窗口的高度；
		scrolll_hght = dh - to_top - wh; //滚动到底部的位置；
		//返回到顶部按钮
		if (to_top > wh) {
			$("#to-top").show();
		} else {
			$("#to-top").hide();
		};
	});

});